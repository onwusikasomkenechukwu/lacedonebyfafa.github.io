<!DOCTYPE HTML>
<html>
<head>
	<title>Lace Done by Fafa</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	<style>
		/* Booking Section Styling */
		#booking-section {
			background: #fff;
			max-width: 800px;
			margin: 3rem auto;
			padding: 2rem;
			border-radius: 10px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.1);
			font-family: 'Poppins', sans-serif;
		}
		#booking-section h2 {
			text-align: center;
			color: #f06292;
			border-bottom: 2px solid #eee;
			padding-bottom: 0.5rem;
		}
		#booking-section label {
			display: block;
			margin-top: 1rem;
			font-weight: 600;
			color: #333;
		}
		#booking-section select,
		#booking-section input:not([type="date"]):not([type="time"]):not([type="checkbox"]):not([type="radio"]),
		#booking-section textarea {
			/* Standard input styling for most inputs */
			width: 100%;
			padding: 0.8rem;
			border: 1px solid #ccc;
			border-radius: 6px;
			margin-top: 0.5rem;
			font-size: 1rem;
		}
		/* Specific styling for Date and Time inputs to ensure they take full width */
		#booking-section input[type="date"],
		#booking-section input[type="time"] {
			width: 100%;
			box-sizing: border-box; /* Includes padding and border in the element's total width and height */
			padding: 0.8rem;
			border: 1px solid #ccc;
			border-radius: 6px;
			margin-top: 0.5rem;
			font-size: 1rem;
		}

		#booking-section button,
		#booking-section a.button { /* Style for buttons and the link styled as a button */
			background: #f06292;
			color: white;
			border: none;
			cursor: pointer;
			transition: background 0.3s;
			margin-top: 1.5rem;
			/* Shared button styling */
			width: 100%;
			padding: 0.8rem;
			border-radius: 6px;
			font-size: 1rem;
			text-align: center;
			display: block; /* Ensure the link takes full width like a button */
			text-decoration: none; /* Remove underline from the link */
		}
		#booking-section button:hover,
		#booking-section a.button:hover {
			background: #e04579;
		}
		.hidden { display: none !important; } /* Added !important for safety */
		.summary {
			background: #fdf2f6;
			padding: 1rem;
			border-radius: 8px;
			margin-top: 1rem;
		}
	</style>
</head>

<body class="homepage is-preload">
	<div id="page-wrapper">

		<div id="header">
			<div class="inner">
				<header>
					<h1><a href="index.html" id="logo">☆Lace Done by Fafa☆</a></h1>
					<hr />
					<p>HTX | Howard U!</p>
				</header>
				<footer>
					<a href="#banner" class="button circled scrolly">✧</a>
				</footer>
			</div>

			<nav id="nav">
				<ul>
					<li><a href="index.html">HOME</a></li>
					<li>
						<a href="#booking-section">APPOINTMENTS</a>
						<ul>
							<li>
								<a href="#">LACE INSTALLS</a>
								<ul>
									<li><a href="#booking-section">FRONTAL INSTALL</a></li>
								</ul>
							</li>
							<li><a href="#">VIEW ALL APPOINTMENTS</a></li>
						</ul>
					</li>
				</ul>
			</nav>
		</div>

		<section id="banner">
			<header>
				<h2>Welcome to <strong>Lace Done by Fafa</strong>.</h2>
				<p>Book your next flawless install — simple, smooth, and stunning.</p>
			</header>
		</section>

		<header>
			<h3><strong>STYLES</strong></h3>
		</header>
		<section class="carousel">
			<div class="reel">
				<article><a href="#" class="image featured"><img src="images/lace1.jpg" alt="Lace Install Style 1" /></a></article>
				<article><a href="#" class="image featured"><img src="images/lace2.jpg" alt="Lace Install Style 2" /></a></article>
				<article><a href="#" class="image featured"><img src="images/lace3.jpg" alt="Lace Install Style 3" /></a></article>
			</div>
		</section>

		<div class="wrapper style2">
			<article id="main" class="container special">
				<header>
					<p>
						Get that perfect lace melt with Houston's finest — book your personalized install today.
					</p>
				</header>
				<footer>
					<a href="#booking-section" class="button scrolly">BOOK APPOINTMENT!</a>
				</footer>
			</article>
		</div>

		<section id="booking-section">
			<h2>Book Your Appointment</h2>

			<div id="step1" class="section">
				<label for="service">Select Service:</label>
				<select id="service">
					<option value="">-- Choose a service --</option>
					<option value="Frontal Install - $85">Frontal Install - $85</option>
					</select>
				<button onclick="nextStep(2)">Next →</button>
			</div>

			<div id="step2" class="hidden">
				<label for="date">Select Date:</label>
				<input type="date" id="date" />
				<label for="time">Select Time:</label>
				<input type="time" id="time" />
				<button onclick="nextStep(3)">Next →</button>
			</div>

			<div id="step3" class="hidden">
				<label for="name">Full Name:</label>
				<input type="text" id="name" placeholder="Jane Doe" />
				<label for="notes">Additional Notes (optional):</label>
				<textarea id="notes" rows="4" placeholder="Any special requests?"></textarea>
				<button onclick="showSummary()">Review Appointment →</button>
			</div>

			<div id="step4" class="hidden">
				<h3>Confirm Your Appointment</h3>
				<div class="summary" id="summary"></div>
				<button onclick="generateCalendarLinks()">Confirm & Add to Calendar</button>
			</div>

			<div id="confirmation" class="hidden">
				<h3>✅ Appointment Confirmed!</h3>
				<p>Thank you for booking with Lace Done by Fafa. You can add your appointment to your calendar below:</p>
				<a id="googleLink" target="_blank" class="button">Add to Google Calendar</a>
				<button onclick="generateICS()">Add to Apple Calendar</button>
			</div>
		</section>

		<div id="footer">
			<div class="container">
				<hr />
				<div class="copyright">
					<ul class="menu">
						<li>&copy; Lace Done by Fafa. All rights reserved.</li>
					</ul>
				</div>
			</div>
		</div>
	</div>

	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/jquery.dropotron.min.js"></script>
	<script src="assets/js/jquery.scrolly.min.js"></script>
	<script src="assets/js/jquery.scrollex.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

	<script>

		const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwtz96mlH8A6LjEILa1zE95vmal8Mcd16fRaiq-0--KjoKbTdN2zfktNsuA_h3U8ASF/exec"; 

		const serviceEl = document.getElementById("service");
		const dateEl = document.getElementById("date");
		const timeEl = document.getElementById("time");
		const nameEl = document.getElementById("name");
		const notesEl = document.getElementById("notes");
		const summaryDiv = document.getElementById("summary");

		function nextStep(stepNumber) {
			// Logic for validation before moving to the next step
			let isValid = true;
			let currentStepEl;

			switch (stepNumber) {
				case 2: // Going from Step 1 to Step 2
					currentStepEl = document.getElementById("step1");
					if (!serviceEl.value) {
						alert("Please select a service.");
						isValid = false;
					}
					break;
				case 3: // Going from Step 2 to Step 3
					currentStepEl = document.getElementById("step2");
					if (!dateEl.value || !timeEl.value) {
						alert("Please select a date and time.");
						isValid = false;
					}
					break;
				// No need for a case for step 4, as showSummary handles that transition
			}

			if (isValid) {
				// Hide current step
				currentStepEl.classList.add("hidden");
				// Show next step
				document.getElementById(`step${stepNumber}`).classList.remove("hidden");
			}
		}

		function showSummary() {
			// Going from Step 3 to Step 4 (Summary)
			if (!nameEl.value) {
				alert("Please enter your full name.");
				return;
			}

			summaryDiv.innerHTML = `
				<p><strong>Service:</strong> ${serviceEl.value}</p>
				<p><strong>Date:</strong> ${dateEl.value}</p>
				<p><strong>Time:</strong> ${timeEl.value}</p>
				<p><strong>Name:</strong> ${nameEl.value}</p>
				<p><strong>Notes:</strong> ${notesEl.value || "None"}</p>
			`;
			document.getElementById("step3").classList.add("hidden");
			document.getElementById("step4").classList.remove("hidden");
		}

		function generateCalendarLinks() {
			const service = serviceEl.value;
			const date = dateEl.value;
			const time = timeEl.value;
			const name = nameEl.value;
			const notes = notesEl.value;

			// --- 1. Google Calendar Link Generation ---
			const start = new Date(`${date}T${time}`);
			// Assuming a 60-minute appointment
			const end = new Date(start.getTime() + 120 * 60 * 1000);
			const formatDate = d => d.toISOString().replace(/-|:|\.\d+/g, "");

			document.getElementById("googleLink").href = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(service)}&dates=${formatDate(start)}/${formatDate(end)}&details=${encodeURIComponent(notes)}&location=Houston`;

			// --- 2. Send Booking to Google Apps Script (Backend) ---
			fetch(SCRIPT_URL, {
				method: "POST",
				headers: { "Content-Type": "application/json" },
				body: JSON.stringify({ service, date, time, name, notes })
			})
			.then(res => res.json())
			.then(data => {
				// Success or error handling for the backend save
				if (data.status === "success") {
					console.log("Booking added to spreadsheet successfully!");
				} else {
					console.error("Backend Error:", data);
					// NOTE: Alerting the user about the backend error
					// while still confirming the appointment and providing calendar links
					// as the user's primary action (booking) was completed client-side.
					alert("Note: There was an issue saving your booking details, but you can still use the calendar links.");
				}
			})
			.catch(err => {
				console.error("Fetch Error:", err);
				alert("Note: Failed to communicate with the booking server. Please contact Fafa.");
			});

			// --- 3. Transition to Confirmation Step ---
			document.getElementById("step4").classList.add("hidden");
			document.getElementById("confirmation").classList.remove("hidden");
		}

		function generateICS() {
			// Function to download an ICS file for Apple/Outlook/other calendars
			const service = serviceEl.value;
			const date = dateEl.value;
			const time = timeEl.value;
			const notes = notesEl.value;

			const startDateTime = new Date(`${date}T${time}:00Z`);
			const end = new Date(start.getTime() + 120 * 60 * 1000); // 120 minutes duration
			const ics = `BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
SUMMARY:${service}
DTSTART:${start.toISOString().replace(/[-:]/g,'').split('.')[0]}Z
DTEND:${end.toISOString().replace(/[-:]/g,'').split('.')[0]}Z
DESCRIPTION:${notes}
LOCATION:Houston, TX
END:VEVENT
END:VCALENDAR`;
			const blob = new Blob([ics], {type:"text/calendar"});
			const link = document.createElement("a");
			link.href = URL.createObjectURL(blob);
			link.download = "lace_done_by_fafa_appointment.ics";
			link.click();
		}
	</script>
</body>
</html>






